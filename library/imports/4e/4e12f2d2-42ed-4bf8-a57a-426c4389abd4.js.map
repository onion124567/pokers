{"version":3,"sources":["assets\\scripts\\Game.js"],"names":["PokerUtil","require","AIHelper","self","cc","Class","Component","properties","starPrefab","type","Prefab","cardPrefab","maxStarDuration","minStarDuration","currentCardPosition","startCardPostion","cardWidth","logicHelper","cardArray","String","pokerPlayer","roundPoker","sendArray","playerControlNodeArray","refreshButton","Button","sendButton","currentWinner","gameHost","layoutContainer","Layout","layoutBottom","layoutTop","layoutLeft","layoutRight","logLabel","Label","playLog","ground","Node","player","scoreDisplay","scoreAudio","AudioClip","onLoad","groundY","y","height","timer","starDuration","i","pre","j","str","push","node","on","refreshCallback","sendCallback","publishPokers","score","onRoundCallBack","bind","roundProgram","onUserPlayCallBack","roundOverCallBack","roundHost","currentPlayer","console","log","sendCard","sendAIFollowCard","saveRoundPoker","winnerPosition","sumSocer","setTimeout","destoryArray","appendLog","button","willSendCard","length","getComponent","isCheck","Array","isArray","picNum","message","checkUserCanSend","destroy","splice","index","offset","newStar","instantiate","scaleX","scaleY","addChild","removePokerFromArray","spawnNewStar","setPosition","getNewStarPosition","game","Math","random","spawnBottomCard","destoryNode","createBottomCard","startPosition","userObj","total","randX","randY","jumpHeight","maxX","width","v2","getCardBottomPosition","update","dt","gainScore","string","audioEngine","playEffect","gameOver","stopAllActions","director","loadScene","pokerArray","slice","host","parseInt","playerPokerArray","pokerNum","value","quaryPokerTypeValue","quaryPokerValue","expandPlayer","playerObj","sortPokers","JSON","stringify","location"],"mappings":"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","sourceRoot":"/","sourcesContent":["\r\nlet PokerUtil = require(\"PokerUtil\");\r\nlet AIHelper = require(\"AIHelper\");\r\nlet self;\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        // 这个属性引用了星星预制资源\r\n        starPrefab: {\r\n            default: null,\r\n            type: cc.Prefab\r\n        },\r\n        cardPrefab: {\r\n            default: null,\r\n            type: cc.Prefab\r\n        },\r\n        // 星星产生后消失时间的随机范围\r\n        maxStarDuration: 0,\r\n        minStarDuration: 0,\r\n        currentCardPosition: 0,\r\n        startCardPostion: 0,\r\n        cardWidth: 80,\r\n        logicHelper: null,\r\n        cardArray: [cc.String],\r\n        //初始牌数组 逆时针 主角是第一个数组\r\n        pokerPlayer: [],\r\n        //当前轮次出牌节点,\r\n        roundPoker: [],\r\n        sendArray:[],\r\n        //主角当前牌节点\r\n        playerControlNodeArray: [],\r\n        //洗牌\r\n        refreshButton: {\r\n            default: null,\r\n            type: cc.Button\r\n        },\r\n        //出牌\r\n        sendButton: {\r\n            default: null,\r\n            type: cc.Button\r\n        },\r\n\r\n        //当前胜方\r\n        currentWinner: 1,\r\n        //本轮主\r\n        gameHost: \"1\",\r\n        //玩家拥有牌\r\n        layoutContainer: {\r\n            default: null,\r\n            type: cc.Layout\r\n        },\r\n        //玩家出的牌 \r\n        layoutBottom: {\r\n            default: null,\r\n            type: cc.Layout\r\n        },\r\n        //对家出牌 第三位\r\n        layoutTop: {\r\n            default: null,\r\n            type: cc.Layout\r\n        },\r\n        //下家出牌 左手第二位\r\n        layoutLeft: {\r\n            default: null,\r\n            type: cc.Layout\r\n        },\r\n        //上家出牌，右手第四位\r\n        layoutRight: {\r\n            default: null,\r\n            type: cc.Layout\r\n        },\r\n        //战报\r\n        logLabel: {\r\n            default: null,\r\n            type: cc.Label\r\n        },\r\n        playLog: \"游戏开始\",\r\n        // 地面节点，用于确定星星生成的高度\r\n        ground: {\r\n            default: null,\r\n            type: cc.Node\r\n        },\r\n        // player 节点，用于获取主角弹跳的高度，和控制主角行动开关\r\n        player: {\r\n            default: null,\r\n            type: cc.Node\r\n        },\r\n        // score label 的引用\r\n        scoreDisplay: {\r\n            default: null,\r\n            type: cc.Label\r\n        },\r\n        // 得分音效资源\r\n        scoreAudio: {\r\n            default: null,\r\n            type: cc.AudioClip\r\n        },\r\n    },\r\n\r\n    onLoad: function () {\r\n        self=this;\r\n        // 获取地平面的 y 轴坐标\r\n        this.groundY = this.ground.y + this.ground.height / 2;\r\n        // 初始化计时器\r\n        this.timer = 0;\r\n        this.starDuration = 0;\r\n        this.logicHelper = new AIHelper();\r\n        //创建图片资源\r\n        for (let i = 0; i < 13; i++) {\r\n            let pre = 3 + i;\r\n            for (let j = 1; j < 5; j++) {\r\n                let str = \"\";\r\n                if (pre < 10) {\r\n                    str = \"0\";\r\n                }\r\n                str = str + pre + j;\r\n                this.cardArray.push(str);\r\n                this.cardArray.push(str);\r\n            }\r\n        }\r\n        this.cardArray.push(\"161\");\r\n        this.cardArray.push(\"161\");\r\n        this.cardArray.push(\"171\");\r\n        this.cardArray.push(\"171\");\r\n\r\n\r\n        this.refreshButton.node.on('click', this.refreshCallback, this);\r\n        this.sendButton.node.on('click', this.sendCallback, this);\r\n        this.publishPokers();\r\n        // this.spawnNewStar();\r\n        // 初始化计分\r\n        this.score = 0;\r\n        // this.onRoundCallBack=this.onRoundCallBack.bind(this);\r\n        this.onRoundCallBack=this.onRoundCallBack.bind(this);\r\n        this.logicHelper.roundProgram(this.onUserPlayCallBack,this.onRoundCallBack,this.roundOverCallBack,0,this.gameHost,[]);\r\n    },\r\n    /**\r\n     * 电脑出牌，直接渲染\r\n     * @param gameHost\r\n     * @param roundHost\r\n     * @param sendArray\r\n     * @param currentPlayer\r\n     */\r\n     onRoundCallBack:(gameHost, roundHost, sendArray, currentPlayer)=>{\r\n         self.roundHost=roundHost;\r\n         self.sendArray=sendArray;\r\n         console.log(\"onion\",\"轮次回调\"+sendArray);\r\n       let sendCard= self.logicHelper.sendAIFollowCard(self.gameHost, roundHost, sendArray, self.pokerPlayer[currentPlayer]);\r\n       console.log(\"onion\",\"轮次出牌\"+sendCard);\r\n        // sendArray.push(sendCard);\r\n        self.saveRoundPoker(sendCard, currentPlayer+1, 0);\r\n        return sendCard;\r\n    },\r\n    /**\r\n     * 玩家出牌 出牌按钮可以点击\r\n     * @param gameHost\r\n     * @param roundHost\r\n     * @param sendArray\r\n     * @param currentPlayer\r\n     */\r\n    onUserPlayCallBack:(gameHost, roundHost, sendArray, currentPlayer)=>{\r\n        console.log(\"onion\",\"回调到user\"+sendArray);\r\n    },\r\n\r\n    roundOverCallBack:(winnerPosition,sumSocer)=>{\r\n        setTimeout(()=>{\r\n            PokerUtil.destoryArray(self.roundPoker);\r\n            self.score=sumSocer+self.score;\r\n            self.roundHost=null;\r\n            self.appendLog(winnerPosition+\"大,捞分\"+sumSocer);\r\n            // self.logicHelper.roundProgram(self.onUserPlayCallBack,self.onRoundCallBack,\r\n            //     self.roundOverCallBack,winnerPosition,self.gameHost,[]);\r\n        },1000);\r\n        \r\n    },\r\n\r\n\r\n    refreshCallback: function (button) {\r\n        this.publishPokers();\r\n    },\r\n    sendCallback: function (button) {\r\n        // let sendArray = [];\r\n        let willSendCard=null;\r\n        for (let i = 0; i < this.playerControlNodeArray.length;i++) {\r\n            //判断是否可出\r\n            let node = this.playerControlNodeArray[i].getComponent('Card');\r\n            if (node.isCheck) {\r\n                if(willSendCard&&!Array.isArray(willSendCard)){\r\n                    willSendCard=[];\r\n                    willSendCard.push(node.picNum);\r\n                }else{\r\n                    willSendCard=node.picNum;\r\n                }\r\n                \r\n            }\r\n            // this.playerControlNodeArray[i].destroy();\r\n        }\r\n        let message=this.logicHelper.checkUserCanSend(this.gameHost,this.roundHost,this.pokerPlayer[0],willSendCard);\r\n        if(!message){\r\n            console.log(\"onion\",\"不能出\"+message);\r\n            return\r\n        }\r\n\r\n        //出牌 移除并添加\r\n        for (let i = 0; i < this.playerControlNodeArray.length;) {\r\n            //判断是否可出\r\n            let node = this.playerControlNodeArray[i].getComponent('Card');\r\n            if (node.isCheck) {\r\n                // willSendArray.push(node.picNum);\r\n                this.saveRoundPoker(node.picNum, 1, i * this.cardWidth);\r\n                this.playerControlNodeArray[i].destroy();\r\n                this.playerControlNodeArray.splice(i, 1);\r\n            } else {\r\n                i++;\r\n            }\r\n            // this.playerControlNodeArray[i].destroy();\r\n        }\r\n        if(!this.sendArray){\r\n            this.sendArray=[];\r\n        }\r\n        this.sendArray.push(willSendCard);\r\n        this.logicHelper.roundProgram(this.onUserPlayCallBack,this.onRoundCallBack,\r\n            this.roundOverCallBack,0,this.gameHost,this.sendArray);\r\n       \r\n    },\r\n    //保存出牌  1 2 3 4 顺时针位\r\n    saveRoundPoker: function (picNum, index, offset) {\r\n        var newStar = cc.instantiate(this.cardPrefab);\r\n        // newStar.setPicNum(\"i\"+i);\r\n        newStar.getComponent('Card').picNum = picNum;\r\n        newStar.scaleX = 0.5;\r\n        newStar.scaleY = 0.5;\r\n        this.roundPoker.push(newStar);\r\n        console.log(\"onion\",\"保存出牌\"+picNum+\"index\"+index);\r\n        // this.node.addChild(newStar);\r\n        // let height = this.ground.height / 2 * -1;\r\n        switch (index) {\r\n            case 1: this.layoutBottom.node.addChild(newStar);\r\n                this.logicHelper.removePokerFromArray(this.gameHost, picNum, this.pokerPlayer[0]);\r\n                break;\r\n            case 2: this.layoutLeft.node.addChild(newStar);\r\n                this.logicHelper.removePokerFromArray(this.gameHost, picNum, this.pokerPlayer[1]);\r\n                break;\r\n            case 3: this.layoutTop.node.addChild(newStar);\r\n                this.logicHelper.removePokerFromArray(this.gameHost, picNum, this.pokerPlayer[2]);\r\n                break;\r\n            case 4: this.layoutRight.node.addChild(newStar);\r\n                this.logicHelper.removePokerFromArray(this.gameHost, picNum, this.pokerPlayer[3]);\r\n                break;\r\n        }\r\n        // newStar.setPosition(cc.v2(-150 + this.startCardPostion + offset, height));\r\n    },\r\n    spawnNewStar: function () {\r\n        // 使用给定的模板在场景中生成一个新节点\r\n        var newStar = cc.instantiate(this.starPrefab);\r\n        // 将新增的节点添加到 Canvas 节点下面\r\n        this.node.addChild(newStar);\r\n        // 为星星设置一个随机位置\r\n        newStar.setPosition(this.getNewStarPosition());\r\n        // 在星星组件上暂存 Game 对象的引用\r\n        newStar.getComponent('Star').game = this;\r\n        // 重置计时器，根据消失时间范围随机取一个值\r\n        this.starDuration = this.minStarDuration + Math.random() * (this.maxStarDuration - this.minStarDuration);\r\n        this.timer = 0;\r\n    },\r\n    /**\r\n     * 移除旧的节点\r\n     * 添加新节点\r\n     */\r\n    spawnBottomCard: function () {\r\n        if (this.playerControlNodeArray.length > 0) {\r\n            let destoryNode = this.playerControlNodeArray;\r\n            PokerUtil.destoryArray(destoryNode);\r\n            this.playerControlNodeArray = [];\r\n        }\r\n\r\n        this.createBottomCard()\r\n\r\n    },\r\n\r\n    /**\r\n     * type1Array:type1Array,\r\n            type2Array:type2Array,\r\n            type3Array:type3Array,\r\n            type4Array:type4Array,\r\n            hostArray:hostArray,\r\n            total:total\r\n     */\r\n    createBottomCard: function () {\r\n\r\n        let startPosition = 0;\r\n        let userObj = this.pokerPlayer[0];\r\n        for (let i = 0; i < userObj.total.length; i++) {\r\n            // 使用给定的模板在场景中生成一个新节点\r\n            var newStar = cc.instantiate(this.cardPrefab);\r\n            // newStar.setPicNum(\"i\"+i);\r\n            newStar.getComponent('Card').picNum = userObj.total[i];\r\n            this.playerControlNodeArray.push(newStar);\r\n            // this.node.addChild(newStar);\r\n            this.layoutContainer.node.addChild(newStar);\r\n            let height = this.ground.height / 2 * -1;\r\n            startPosition = i * this.cardWidth;\r\n            if (i > 13) {\r\n                height = height - 150\r\n                startPosition = (i - 13) * this.cardWidth;\r\n            }\r\n            // newStar.setPosition(cc.v2(-200 + this.startCardPostion + startPosition, height));\r\n        }\r\n    },\r\n\r\n\r\n    getNewStarPosition: function () {\r\n        var randX = 0;\r\n        // 根据地平面位置和主角跳跃高度，随机得到一个星星的 y 坐标\r\n        var randY = this.groundY + Math.random() * this.player.getComponent('Player').jumpHeight + 50;\r\n        // 根据屏幕宽度，随机得到一个星星 x 坐标\r\n        var maxX = this.node.width / 2;\r\n        randX = (Math.random() - 0.5) * 2 * maxX;\r\n        // 返回星星坐标\r\n        return cc.v2(randX, randY);\r\n    },\r\n    getCardBottomPosition: function () {\r\n        var randX = this.currentCardPosition;\r\n        var randY = 0;\r\n        this.currentCardPosition = this.currentCardPosition + this.cardWidth;\r\n        return cc.v2(randX, randY);\r\n    },\r\n\r\n    update: function (dt) {\r\n        // 每帧更新计时器，超过限度还没有生成新的星星\r\n        // 就会调用游戏失败逻辑\r\n        // if (this.timer > this.starDuration) {\r\n        //     this.gameOver();\r\n        //     this.enabled = false;   // disable gameOver logic to avoid load scene repeatedly\r\n        //     return;\r\n        // }\r\n        // this.timer += dt;\r\n    },\r\n\r\n    gainScore: function () {\r\n        this.score += 1;\r\n        // 更新 scoreDisplay Label 的文字\r\n        this.scoreDisplay.string = 'Score: ' + this.score;\r\n        // 播放得分音效\r\n        cc.audioEngine.playEffect(this.scoreAudio, false);\r\n    },\r\n\r\n    gameOver: function () {\r\n        this.player.stopAllActions(); //停止 player 节点的跳跃动作\r\n        cc.director.loadScene('game');\r\n    },\r\n\r\n    /**\r\n    * 把牌发给四家\r\n    */\r\n    publishPokers: function () {\r\n        this.pokerPlayer = [];\r\n        this.gameHost = null;\r\n        let pokerArray = this.cardArray.slice(0);\r\n        let host = parseInt(Math.random() * 4);//随机主牌花色\r\n        for (let i = 0; i < 4; i++) {\r\n            let playerPokerArray = [];\r\n            for (let j = 0; j < 27; j++) {\r\n                let pokerNum = Math.random() * pokerArray.length;\r\n                pokerNum = parseInt(pokerNum);\r\n                //插入手牌中\r\n                let value = pokerArray.splice(pokerNum, 1);\r\n                playerPokerArray.push(value);\r\n                if (this.gameHost == null) {//随机到主后，第一张主牌亮出\r\n                    if (host == PokerUtil.quaryPokerTypeValue(value)) {\r\n                        this.gameHost = value;\r\n                        this.appendLog(\"本轮游戏,主牌\" + PokerUtil.quaryPokerValue(value) + \"在\" + this.expandPlayer(i));\r\n                    }\r\n                }\r\n            }\r\n            let playerObj = PokerUtil.sortPokers(host, playerPokerArray);\r\n            console.log(\"onion====\", JSON.stringify(playerObj));\r\n            this.pokerPlayer.push(playerObj);\r\n        }\r\n        this.spawnBottomCard();\r\n\r\n    },\r\n    expandPlayer: function (location) {\r\n        switch (location) {\r\n            case 0: return \"自己\"\r\n            case 1: return \"下家\"\r\n            case 2: return \"对家\"\r\n            case 3: return \"上家\"\r\n        }\r\n\r\n    },\r\n    appendLog: function (string) {\r\n        this.playLog = this.playLog + \"\\n\" + string;\r\n        this.logLabel.string = this.playLog;\r\n    }\r\n\r\n\r\n\r\n\r\n\r\n});\r\n"]}