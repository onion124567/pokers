
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/scripts/Game.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, '4e12fLSQu1L+KV6QmxDiavU', 'Game');
// scripts/Game.js

"use strict";

var PokerUtil = require("PokerUtil");

cc.Class({
  "extends": cc.Component,
  properties: {
    // 这个属性引用了星星预制资源
    starPrefab: {
      "default": null,
      type: cc.Prefab
    },
    cardPrefab: {
      "default": null,
      type: cc.Prefab
    },
    // 星星产生后消失时间的随机范围
    maxStarDuration: 0,
    minStarDuration: 0,
    currentCardPosition: 0,
    startCardPostion: 0,
    cardWidth: 80,
    cardArray: [cc.String],
    //初始牌数组 逆时针 主角是第一个数组
    pokerPlayer: [],
    //当前轮次出牌节点,
    roundPoker: [],
    //主角当前牌节点
    playerControlNodeArray: [],
    //洗牌
    refreshButton: {
      "default": null,
      type: cc.Button
    },
    //出牌
    sendButton: {
      "default": null,
      type: cc.Button
    },
    //当前胜方
    currentWinner: 1,
    //本轮主
    gameHost: "1",
    //玩家拥有牌
    layoutContainer: {
      "default": null,
      type: cc.Layout
    },
    //玩家出的牌 
    layoutBottom: {
      "default": null,
      type: cc.Layout
    },
    //对家出牌 第三位
    layoutTop: {
      "default": null,
      type: cc.Layout
    },
    //下家出牌 左手第二位
    layoutLeft: {
      "default": null,
      type: cc.Layout
    },
    //上家出牌，右手第四位
    layoutRight: {
      "default": null,
      type: cc.Layout
    },
    //战报
    logLabel: {
      "default": null,
      type: cc.Label
    },
    playLog: "游戏开始",
    // 地面节点，用于确定星星生成的高度
    ground: {
      "default": null,
      type: cc.Node
    },
    // player 节点，用于获取主角弹跳的高度，和控制主角行动开关
    player: {
      "default": null,
      type: cc.Node
    },
    // score label 的引用
    scoreDisplay: {
      "default": null,
      type: cc.Label
    },
    // 得分音效资源
    scoreAudio: {
      "default": null,
      type: cc.AudioClip
    }
  },
  onLoad: function onLoad() {
    // 获取地平面的 y 轴坐标
    this.groundY = this.ground.y + this.ground.height / 2; // 初始化计时器

    this.timer = 0;
    this.starDuration = 0; //创建图片资源

    for (var i = 0; i < 13; i++) {
      var pre = 3 + i;

      for (var j = 1; j < 5; j++) {
        var str = "";

        if (pre < 10) {
          str = "0";
        }

        str = str + pre + j;
        this.cardArray.push(str);
        this.cardArray.push(str);
      }
    }

    this.cardArray.push("161");
    this.cardArray.push("161");
    this.cardArray.push("171");
    this.cardArray.push("171");
    this.refreshButton.node.on('click', this.refreshCallback, this);
    this.sendButton.node.on('click', this.sendCallback, this);
    this.publishPokers(); // this.spawnNewStar();
    // 初始化计分

    this.score = 0;
  },
  refreshCallback: function refreshCallback(button) {
    this.publishPokers();
  },
  sendCallback: function sendCallback(button) {
    var testArray = [];
    PokerUtil.destoryArray(this.roundPoker);

    for (var i = 0; i < this.playerControlNodeArray.length;) {
      //判断是否可出
      var node = this.playerControlNodeArray[i].getComponent('Card');

      if (node.isCheck) {
        console.log("onion 选中" + PokerUtil.quaryPokerValue(node.picNum));
        testArray.push(node.picNum);
        this.saveRoundPoker(node.picNum, 1, i * this.cardWidth);
        this.playerControlNodeArray[i].destroy();
        this.playerControlNodeArray.splice(i, 1);
      } else {
        i++;
      } // this.playerControlNodeArray[i].destroy();

    }

    PokerUtil.testLogic(testArray);
    this.appendLog("追加牌内容");
  },
  //保存出牌  1 2 3 4 顺时针位
  saveRoundPoker: function saveRoundPoker(picNum, index, offset) {
    var newStar = cc.instantiate(this.cardPrefab); // newStar.setPicNum("i"+i);

    newStar.getComponent('Card').picNum = picNum;
    newStar.scaleX = 0.5;
    newStar.scaleY = 0.5;
    this.roundPoker.push(newStar); // this.node.addChild(newStar);
    // let height = this.ground.height / 2 * -1;

    if (index === 1) {
      // height = height + 100;
      this.layoutBottom.node.addChild(newStar);
    } // newStar.setPosition(cc.v2(-150 + this.startCardPostion + offset, height));

  },
  spawnNewStar: function spawnNewStar() {
    // 使用给定的模板在场景中生成一个新节点
    var newStar = cc.instantiate(this.starPrefab); // 将新增的节点添加到 Canvas 节点下面

    this.node.addChild(newStar); // 为星星设置一个随机位置

    newStar.setPosition(this.getNewStarPosition()); // 在星星组件上暂存 Game 对象的引用

    newStar.getComponent('Star').game = this; // 重置计时器，根据消失时间范围随机取一个值

    this.starDuration = this.minStarDuration + Math.random() * (this.maxStarDuration - this.minStarDuration);
    this.timer = 0;
  },

  /**
   * 移除旧的节点
   * 添加新节点
   */
  spawnBottomCard: function spawnBottomCard() {
    if (this.playerControlNodeArray.length > 0) {
      var destoryNode = this.playerControlNodeArray;
      PokerUtil.destoryArray(destoryNode);
      this.playerControlNodeArray = [];
    }

    console.log("spawnBottomCard " + this.pokerPlayer[0].length);
    this.createBottomCard();
  },
  createBottomCard: function createBottomCard() {
    var startPosition = 0;

    for (var i = 0; i < this.pokerPlayer[0].length; i++) {
      // 使用给定的模板在场景中生成一个新节点
      var newStar = cc.instantiate(this.cardPrefab); // newStar.setPicNum("i"+i);

      newStar.getComponent('Card').picNum = this.pokerPlayer[0][i];
      this.playerControlNodeArray.push(newStar); // this.node.addChild(newStar);

      this.layoutContainer.node.addChild(newStar);
      var height = this.ground.height / 2 * -1;
      startPosition = i * this.cardWidth;

      if (i > 13) {
        height = height - 150;
        startPosition = (i - 13) * this.cardWidth;
      } // newStar.setPosition(cc.v2(-200 + this.startCardPostion + startPosition, height));

    }
  },
  getNewStarPosition: function getNewStarPosition() {
    var randX = 0; // 根据地平面位置和主角跳跃高度，随机得到一个星星的 y 坐标

    var randY = this.groundY + Math.random() * this.player.getComponent('Player').jumpHeight + 50; // 根据屏幕宽度，随机得到一个星星 x 坐标

    var maxX = this.node.width / 2;
    randX = (Math.random() - 0.5) * 2 * maxX; // 返回星星坐标

    return cc.v2(randX, randY);
  },
  getCardBottomPosition: function getCardBottomPosition() {
    var randX = this.currentCardPosition;
    var randY = 0;
    this.currentCardPosition = this.currentCardPosition + this.cardWidth;
    return cc.v2(randX, randY);
  },
  update: function update(dt) {// 每帧更新计时器，超过限度还没有生成新的星星
    // 就会调用游戏失败逻辑
    // if (this.timer > this.starDuration) {
    //     this.gameOver();
    //     this.enabled = false;   // disable gameOver logic to avoid load scene repeatedly
    //     return;
    // }
    // this.timer += dt;
  },
  gainScore: function gainScore() {
    this.score += 1; // 更新 scoreDisplay Label 的文字

    this.scoreDisplay.string = 'Score: ' + this.score; // 播放得分音效

    cc.audioEngine.playEffect(this.scoreAudio, false);
  },
  gameOver: function gameOver() {
    this.player.stopAllActions(); //停止 player 节点的跳跃动作

    cc.director.loadScene('game');
  },

  /**
  * 把牌发给四家
  */
  publishPokers: function publishPokers() {
    this.pokerPlayer = [];
    this.gameHost = null;
    var pokerArray = this.cardArray.slice(0);
    var host = parseInt(Math.random() * 4); //随机主牌花色

    for (var i = 0; i < 4; i++) {
      var playerPokerArray = [];

      for (var j = 0; j < 27; j++) {
        var pokerNum = Math.random() * pokerArray.length;
        pokerNum = parseInt(pokerNum); //插入手牌中

        var value = pokerArray.splice(pokerNum, 1);
        playerPokerArray.push(value);

        if (this.gameHost == null) {
          //随机到主后，第一张主牌亮出
          if (host == PokerUtil.quaryPokerTypeValue(value)) {
            this.gameHost = value;
            this.appendLog("本轮游戏主" + PokerUtil.quaryType(this.gameHost) + ",主牌" + PokerUtil.quaryPokerValue(value) + "在" + this.expandPlayer(i));
          }
        }
      }

      var playerObj = PokerUtil.sortPokers(host, playerPokerArray);
      console.log("onion", JSON.stringify(playerObj));
      this.pokerPlayer.push(playerObj.total);
    }

    this.spawnBottomCard();
  },
  expandPlayer: function expandPlayer(location) {
    switch (location) {
      case 0:
        return "自己";

      case 1:
        return "下家";

      case 2:
        return "对家";

      case 3:
        return "上家";
    }
  },
  appendLog: function appendLog(string) {
    this.playLog = this.playLog + "\n" + string;
    this.logLabel.string = this.playLog;
  }
});

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcc2NyaXB0c1xcR2FtZS5qcyJdLCJuYW1lcyI6WyJQb2tlclV0aWwiLCJyZXF1aXJlIiwiY2MiLCJDbGFzcyIsIkNvbXBvbmVudCIsInByb3BlcnRpZXMiLCJzdGFyUHJlZmFiIiwidHlwZSIsIlByZWZhYiIsImNhcmRQcmVmYWIiLCJtYXhTdGFyRHVyYXRpb24iLCJtaW5TdGFyRHVyYXRpb24iLCJjdXJyZW50Q2FyZFBvc2l0aW9uIiwic3RhcnRDYXJkUG9zdGlvbiIsImNhcmRXaWR0aCIsImNhcmRBcnJheSIsIlN0cmluZyIsInBva2VyUGxheWVyIiwicm91bmRQb2tlciIsInBsYXllckNvbnRyb2xOb2RlQXJyYXkiLCJyZWZyZXNoQnV0dG9uIiwiQnV0dG9uIiwic2VuZEJ1dHRvbiIsImN1cnJlbnRXaW5uZXIiLCJnYW1lSG9zdCIsImxheW91dENvbnRhaW5lciIsIkxheW91dCIsImxheW91dEJvdHRvbSIsImxheW91dFRvcCIsImxheW91dExlZnQiLCJsYXlvdXRSaWdodCIsImxvZ0xhYmVsIiwiTGFiZWwiLCJwbGF5TG9nIiwiZ3JvdW5kIiwiTm9kZSIsInBsYXllciIsInNjb3JlRGlzcGxheSIsInNjb3JlQXVkaW8iLCJBdWRpb0NsaXAiLCJvbkxvYWQiLCJncm91bmRZIiwieSIsImhlaWdodCIsInRpbWVyIiwic3RhckR1cmF0aW9uIiwiaSIsInByZSIsImoiLCJzdHIiLCJwdXNoIiwibm9kZSIsIm9uIiwicmVmcmVzaENhbGxiYWNrIiwic2VuZENhbGxiYWNrIiwicHVibGlzaFBva2VycyIsInNjb3JlIiwiYnV0dG9uIiwidGVzdEFycmF5IiwiZGVzdG9yeUFycmF5IiwibGVuZ3RoIiwiZ2V0Q29tcG9uZW50IiwiaXNDaGVjayIsImNvbnNvbGUiLCJsb2ciLCJxdWFyeVBva2VyVmFsdWUiLCJwaWNOdW0iLCJzYXZlUm91bmRQb2tlciIsImRlc3Ryb3kiLCJzcGxpY2UiLCJ0ZXN0TG9naWMiLCJhcHBlbmRMb2ciLCJpbmRleCIsIm9mZnNldCIsIm5ld1N0YXIiLCJpbnN0YW50aWF0ZSIsInNjYWxlWCIsInNjYWxlWSIsImFkZENoaWxkIiwic3Bhd25OZXdTdGFyIiwic2V0UG9zaXRpb24iLCJnZXROZXdTdGFyUG9zaXRpb24iLCJnYW1lIiwiTWF0aCIsInJhbmRvbSIsInNwYXduQm90dG9tQ2FyZCIsImRlc3RvcnlOb2RlIiwiY3JlYXRlQm90dG9tQ2FyZCIsInN0YXJ0UG9zaXRpb24iLCJyYW5kWCIsInJhbmRZIiwianVtcEhlaWdodCIsIm1heFgiLCJ3aWR0aCIsInYyIiwiZ2V0Q2FyZEJvdHRvbVBvc2l0aW9uIiwidXBkYXRlIiwiZHQiLCJnYWluU2NvcmUiLCJzdHJpbmciLCJhdWRpb0VuZ2luZSIsInBsYXlFZmZlY3QiLCJnYW1lT3ZlciIsInN0b3BBbGxBY3Rpb25zIiwiZGlyZWN0b3IiLCJsb2FkU2NlbmUiLCJwb2tlckFycmF5Iiwic2xpY2UiLCJob3N0IiwicGFyc2VJbnQiLCJwbGF5ZXJQb2tlckFycmF5IiwicG9rZXJOdW0iLCJ2YWx1ZSIsInF1YXJ5UG9rZXJUeXBlVmFsdWUiLCJxdWFyeVR5cGUiLCJleHBhbmRQbGF5ZXIiLCJwbGF5ZXJPYmoiLCJzb3J0UG9rZXJzIiwiSlNPTiIsInN0cmluZ2lmeSIsInRvdGFsIiwibG9jYXRpb24iXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQ0MsSUFBSUEsU0FBUyxHQUFHQyxPQUFPLENBQUMsV0FBRCxDQUF2Qjs7QUFDREMsRUFBRSxDQUFDQyxLQUFILENBQVM7QUFDTCxhQUFTRCxFQUFFLENBQUNFLFNBRFA7QUFHTEMsRUFBQUEsVUFBVSxFQUFFO0FBQ1I7QUFDQUMsSUFBQUEsVUFBVSxFQUFFO0FBQ1IsaUJBQVMsSUFERDtBQUVSQyxNQUFBQSxJQUFJLEVBQUVMLEVBQUUsQ0FBQ007QUFGRCxLQUZKO0FBTVJDLElBQUFBLFVBQVUsRUFBRTtBQUNSLGlCQUFTLElBREQ7QUFFUkYsTUFBQUEsSUFBSSxFQUFFTCxFQUFFLENBQUNNO0FBRkQsS0FOSjtBQVVSO0FB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LyIsInNvdXJjZXNDb250ZW50IjpbIlxuIGxldCBQb2tlclV0aWwgPSByZXF1aXJlKFwiUG9rZXJVdGlsXCIpO1xuY2MuQ2xhc3Moe1xuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcblxuICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgLy8g6L+Z5Liq5bGe5oCn5byV55So5LqG5pif5pif6aKE5Yi26LWE5rqQXG4gICAgICAgIHN0YXJQcmVmYWI6IHtcbiAgICAgICAgICAgIGRlZmF1bHQ6IG51bGwsXG4gICAgICAgICAgICB0eXBlOiBjYy5QcmVmYWJcbiAgICAgICAgfSxcbiAgICAgICAgY2FyZFByZWZhYjoge1xuICAgICAgICAgICAgZGVmYXVsdDogbnVsbCxcbiAgICAgICAgICAgIHR5cGU6IGNjLlByZWZhYlxuICAgICAgICB9LFxuICAgICAgICAvLyDmmJ/mmJ/kuqfnlJ/lkI7mtojlpLHml7bpl7TnmoTpmo/mnLrojIPlm7RcbiAgICAgICAgbWF4U3RhckR1cmF0aW9uOiAwLFxuICAgICAgICBtaW5TdGFyRHVyYXRpb246IDAsXG4gICAgICAgIGN1cnJlbnRDYXJkUG9zaXRpb246IDAsXG4gICAgICAgIHN0YXJ0Q2FyZFBvc3Rpb246IDAsXG4gICAgICAgIGNhcmRXaWR0aDogODAsXG4gICAgICAgIFxuICAgICAgICBjYXJkQXJyYXk6IFtjYy5TdHJpbmddLFxuICAgICAgICAvL+WIneWni+eJjOaVsOe7hCDpgIbml7bpkogg5Li76KeS5piv56ys5LiA5Liq5pWw57uEXG4gICAgICAgIHBva2VyUGxheWVyOiBbXSxcbiAgICAgICAgLy/lvZPliY3ova7mrKHlh7rniYzoioLngrksXG4gICAgICAgIHJvdW5kUG9rZXI6IFtdLFxuICAgICAgICAvL+S4u+inkuW9k+WJjeeJjOiKgueCuVxuICAgICAgICBwbGF5ZXJDb250cm9sTm9kZUFycmF5OiBbXSxcbiAgICAgICAgLy/mtJfniYxcbiAgICAgICAgcmVmcmVzaEJ1dHRvbjoge1xuICAgICAgICAgICAgZGVmYXVsdDogbnVsbCxcbiAgICAgICAgICAgIHR5cGU6IGNjLkJ1dHRvblxuICAgICAgICB9LFxuICAgICAgICAvL+WHuueJjFxuICAgICAgICBzZW5kQnV0dG9uOiB7XG4gICAgICAgICAgICBkZWZhdWx0OiBudWxsLFxuICAgICAgICAgICAgdHlwZTogY2MuQnV0dG9uXG4gICAgICAgIH0sXG5cbiAgICAgICAgLy/lvZPliY3og5zmlrlcbiAgICAgICAgY3VycmVudFdpbm5lcjoxLFxuICAgICAgICAvL+acrOi9ruS4u1xuICAgICAgICBnYW1lSG9zdDpcIjFcIixcbiAgICAgICAgLy/njqnlrrbmi6XmnInniYxcbiAgICAgICAgbGF5b3V0Q29udGFpbmVyOntcbiAgICAgICAgICAgIGRlZmF1bHQ6bnVsbCxcbiAgICAgICAgICAgIHR5cGU6Y2MuTGF5b3V0XG4gICAgICAgIH0sXG4gICAgICAgIC8v546p5a625Ye655qE54mMIFxuICAgICAgICBsYXlvdXRCb3R0b206e1xuICAgICAgICAgICAgZGVmYXVsdDpudWxsLFxuICAgICAgICAgICAgdHlwZTpjYy5MYXlvdXRcbiAgICAgICAgfSxcbiAgICAgICAgLy/lr7nlrrblh7rniYwg56ys5LiJ5L2NXG4gICAgICAgIGxheW91dFRvcDp7XG4gICAgICAgICAgICBkZWZhdWx0Om51bGwsXG4gICAgICAgICAgICB0eXBlOmNjLkxheW91dFxuICAgICAgICB9LFxuICAgICAgICAvL+S4i+WutuWHuueJjCDlt6bmiYvnrKzkuozkvY1cbiAgICAgICAgbGF5b3V0TGVmdDp7XG4gICAgICAgICAgICBkZWZhdWx0Om51bGwsXG4gICAgICAgICAgICB0eXBlOmNjLkxheW91dFxuICAgICAgICB9LFxuICAgICAgICAgLy/kuIrlrrblh7rniYzvvIzlj7PmiYvnrKzlm5vkvY1cbiAgICAgICAgbGF5b3V0UmlnaHQ6e1xuICAgICAgICAgICAgZGVmYXVsdDpudWxsLFxuICAgICAgICAgICAgdHlwZTpjYy5MYXlvdXRcbiAgICAgICAgfSxcbiAgICAgICAgLy/miJjmiqVcbiAgICAgICAgbG9nTGFiZWw6e1xuICAgICAgICAgICAgZGVmYXVsdDpudWxsLFxuICAgICAgICAgICAgdHlwZTpjYy5MYWJlbFxuICAgICAgICB9LFxuICAgICAgICBwbGF5TG9nOlwi5ri45oiP5byA5aeLXCIsXG4gICAgICAgIC8vIOWcsOmdouiKgueCue+8jOeUqOS6juehruWumuaYn+aYn+eUn+aIkOeahOmrmOW6plxuICAgICAgICBncm91bmQ6IHtcbiAgICAgICAgICAgIGRlZmF1bHQ6IG51bGwsXG4gICAgICAgICAgICB0eXBlOiBjYy5Ob2RlXG4gICAgICAgIH0sXG4gICAgICAgIC8vIHBsYXllciDoioLngrnvvIznlKjkuo7ojrflj5bkuLvop5LlvLnot7PnmoTpq5jluqbvvIzlkozmjqfliLbkuLvop5LooYzliqjlvIDlhbNcbiAgICAgICAgcGxheWVyOiB7XG4gICAgICAgICAgICBkZWZhdWx0OiBudWxsLFxuICAgICAgICAgICAgdHlwZTogY2MuTm9kZVxuICAgICAgICB9LFxuICAgICAgICAvLyBzY29yZSBsYWJlbCDnmoTlvJXnlKhcbiAgICAgICAgc2NvcmVEaXNwbGF5OiB7XG4gICAgICAgICAgICBkZWZhdWx0OiBudWxsLFxuICAgICAgICAgICAgdHlwZTogY2MuTGFiZWxcbiAgICAgICAgfSxcbiAgICAgICAgLy8g5b6X5YiG6Z+z5pWI6LWE5rqQXG4gICAgICAgIHNjb3JlQXVkaW86IHtcbiAgICAgICAgICAgIGRlZmF1bHQ6IG51bGwsXG4gICAgICAgICAgICB0eXBlOiBjYy5BdWRpb0NsaXBcbiAgICAgICAgfSxcbiAgICB9LFxuXG4gICAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIC8vIOiOt+WPluWcsOW5s+mdoueahCB5IOi9tOWdkOagh1xuICAgICAgICB0aGlzLmdyb3VuZFkgPSB0aGlzLmdyb3VuZC55ICsgdGhpcy5ncm91bmQuaGVpZ2h0IC8gMjtcbiAgICAgICAgLy8g5Yid5aeL5YyW6K6h5pe25ZmoXG4gICAgICAgIHRoaXMudGltZXIgPSAwO1xuICAgICAgICB0aGlzLnN0YXJEdXJhdGlvbiA9IDA7XG4gICAgICAgIC8v5Yib5bu65Zu+54mH6LWE5rqQXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgMTM7IGkrKykge1xuICAgICAgICAgICAgbGV0IHByZSA9IDMgKyBpO1xuICAgICAgICAgICAgZm9yIChsZXQgaiA9IDE7IGogPCA1OyBqKyspIHtcbiAgICAgICAgICAgICAgICBsZXQgc3RyID0gXCJcIjtcbiAgICAgICAgICAgICAgICBpZiAocHJlIDwgMTApIHtcbiAgICAgICAgICAgICAgICAgICAgc3RyID0gXCIwXCI7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHN0ciA9IHN0ciArIHByZSArIGo7XG4gICAgICAgICAgICAgICAgdGhpcy5jYXJkQXJyYXkucHVzaChzdHIpO1xuICAgICAgICAgICAgICAgIHRoaXMuY2FyZEFycmF5LnB1c2goc3RyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB0aGlzLmNhcmRBcnJheS5wdXNoKFwiMTYxXCIpO1xuICAgICAgICB0aGlzLmNhcmRBcnJheS5wdXNoKFwiMTYxXCIpO1xuICAgICAgICB0aGlzLmNhcmRBcnJheS5wdXNoKFwiMTcxXCIpO1xuICAgICAgICB0aGlzLmNhcmRBcnJheS5wdXNoKFwiMTcxXCIpO1xuXG5cbiAgICAgICAgdGhpcy5yZWZyZXNoQnV0dG9uLm5vZGUub24oJ2NsaWNrJywgdGhpcy5yZWZyZXNoQ2FsbGJhY2ssIHRoaXMpO1xuICAgICAgICB0aGlzLnNlbmRCdXR0b24ubm9kZS5vbignY2xpY2snLCB0aGlzLnNlbmRDYWxsYmFjaywgdGhpcyk7XG4gICAgICAgIHRoaXMucHVibGlzaFBva2VycygpO1xuICAgICAgICAvLyB0aGlzLnNwYXduTmV3U3RhcigpO1xuICAgICAgICAvLyDliJ3lp4vljJborqHliIZcbiAgICAgICAgdGhpcy5zY29yZSA9IDA7XG4gICAgfSxcbiAgICByZWZyZXNoQ2FsbGJhY2s6IGZ1bmN0aW9uIChidXR0b24pIHtcbiAgICAgICAgdGhpcy5wdWJsaXNoUG9rZXJzKCk7XG4gICAgfSxcbiAgICBzZW5kQ2FsbGJhY2s6IGZ1bmN0aW9uIChidXR0b24pIHtcbiAgICAgICAgbGV0IHRlc3RBcnJheT1bXTtcbiAgICAgICAgUG9rZXJVdGlsLmRlc3RvcnlBcnJheSh0aGlzLnJvdW5kUG9rZXIpO1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMucGxheWVyQ29udHJvbE5vZGVBcnJheS5sZW5ndGg7KSB7XG4gICAgICAgICAgICAvL+WIpOaWreaYr+WQpuWPr+WHulxuICAgICAgICAgICAgbGV0IG5vZGUgPSB0aGlzLnBsYXllckNvbnRyb2xOb2RlQXJyYXlbaV0uZ2V0Q29tcG9uZW50KCdDYXJkJyk7XG4gICAgICAgICAgICBpZiAobm9kZS5pc0NoZWNrKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJvbmlvbiDpgInkuK1cIiArIFBva2VyVXRpbC5xdWFyeVBva2VyVmFsdWUobm9kZS5waWNOdW0pKTtcbiAgICAgICAgICAgICAgICB0ZXN0QXJyYXkucHVzaChub2RlLnBpY051bSk7XG4gICAgICAgICAgICAgICAgdGhpcy5zYXZlUm91bmRQb2tlcihub2RlLnBpY051bSwgMSwgaSAqIHRoaXMuY2FyZFdpZHRoKTtcbiAgICAgICAgICAgICAgICB0aGlzLnBsYXllckNvbnRyb2xOb2RlQXJyYXlbaV0uZGVzdHJveSgpO1xuICAgICAgICAgICAgICAgIHRoaXMucGxheWVyQ29udHJvbE5vZGVBcnJheS5zcGxpY2UoaSwgMSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGkrKztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIHRoaXMucGxheWVyQ29udHJvbE5vZGVBcnJheVtpXS5kZXN0cm95KCk7XG4gICAgICAgIH1cbiAgICAgICAgIFBva2VyVXRpbC50ZXN0TG9naWModGVzdEFycmF5KTtcbiAgICAgICAgIHRoaXMuYXBwZW5kTG9nKFwi6L+95Yqg54mM5YaF5a65XCIpO1xuICAgIH0sXG4gICAgLy/kv53lrZjlh7rniYwgIDEgMiAzIDQg6aG65pe26ZKI5L2NXG4gICAgc2F2ZVJvdW5kUG9rZXI6IGZ1bmN0aW9uIChwaWNOdW0sIGluZGV4LCBvZmZzZXQpIHtcbiAgICAgICAgdmFyIG5ld1N0YXIgPSBjYy5pbnN0YW50aWF0ZSh0aGlzLmNhcmRQcmVmYWIpO1xuICAgICAgICAvLyBuZXdTdGFyLnNldFBpY051bShcImlcIitpKTtcbiAgICAgICAgbmV3U3Rhci5nZXRDb21wb25lbnQoJ0NhcmQnKS5waWNOdW0gPSBwaWNOdW07XG4gICAgICAgIG5ld1N0YXIuc2NhbGVYID0gMC41O1xuICAgICAgICBuZXdTdGFyLnNjYWxlWSA9IDAuNTtcbiAgICAgICAgdGhpcy5yb3VuZFBva2VyLnB1c2gobmV3U3Rhcik7XG4gICAgICAgIC8vIHRoaXMubm9kZS5hZGRDaGlsZChuZXdTdGFyKTtcbiAgICAgICAgLy8gbGV0IGhlaWdodCA9IHRoaXMuZ3JvdW5kLmhlaWdodCAvIDIgKiAtMTtcbiAgICAgICAgaWYgKGluZGV4ID09PSAxKSB7XG4gICAgICAgICAgICAvLyBoZWlnaHQgPSBoZWlnaHQgKyAxMDA7XG4gICAgICAgICAgICB0aGlzLmxheW91dEJvdHRvbS5ub2RlLmFkZENoaWxkKG5ld1N0YXIpO1xuICAgICAgICB9XG4gICAgICAgIC8vIG5ld1N0YXIuc2V0UG9zaXRpb24oY2MudjIoLTE1MCArIHRoaXMuc3RhcnRDYXJkUG9zdGlvbiArIG9mZnNldCwgaGVpZ2h0KSk7XG4gICAgfSxcbiAgICBzcGF3bk5ld1N0YXI6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgLy8g5L2/55So57uZ5a6a55qE5qih5p2/5Zyo5Zy65pmv5Lit55Sf5oiQ5LiA5Liq5paw6IqC54K5XG4gICAgICAgIHZhciBuZXdTdGFyID0gY2MuaW5zdGFudGlhdGUodGhpcy5zdGFyUHJlZmFiKTtcbiAgICAgICAgLy8g5bCG5paw5aKe55qE6IqC54K55re75Yqg5YiwIENhbnZhcyDoioLngrnkuIvpnaJcbiAgICAgICAgdGhpcy5ub2RlLmFkZENoaWxkKG5ld1N0YXIpO1xuICAgICAgICAvLyDkuLrmmJ/mmJ/orr7nva7kuIDkuKrpmo/mnLrkvY3nva5cbiAgICAgICAgbmV3U3Rhci5zZXRQb3NpdGlvbih0aGlzLmdldE5ld1N0YXJQb3NpdGlvbigpKTtcbiAgICAgICAgLy8g5Zyo5pif5pif57uE5Lu25LiK5pqC5a2YIEdhbWUg5a+56LGh55qE5byV55SoXG4gICAgICAgIG5ld1N0YXIuZ2V0Q29tcG9uZW50KCdTdGFyJykuZ2FtZSA9IHRoaXM7XG4gICAgICAgIC8vIOmHjee9ruiuoeaXtuWZqO+8jOagueaNrua2iOWkseaXtumXtOiMg+WbtOmaj+acuuWPluS4gOS4quWAvFxuICAgICAgICB0aGlzLnN0YXJEdXJhdGlvbiA9IHRoaXMubWluU3RhckR1cmF0aW9uICsgTWF0aC5yYW5kb20oKSAqICh0aGlzLm1heFN0YXJEdXJhdGlvbiAtIHRoaXMubWluU3RhckR1cmF0aW9uKTtcbiAgICAgICAgdGhpcy50aW1lciA9IDA7XG4gICAgfSxcbiAgICAvKipcbiAgICAgKiDnp7vpmaTml6fnmoToioLngrlcbiAgICAgKiDmt7vliqDmlrDoioLngrlcbiAgICAgKi9cbiAgICBzcGF3bkJvdHRvbUNhcmQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHRoaXMucGxheWVyQ29udHJvbE5vZGVBcnJheS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICBsZXQgZGVzdG9yeU5vZGUgPSB0aGlzLnBsYXllckNvbnRyb2xOb2RlQXJyYXk7XG4gICAgICAgICAgICBQb2tlclV0aWwuZGVzdG9yeUFycmF5KGRlc3RvcnlOb2RlKTtcbiAgICAgICAgICAgIHRoaXMucGxheWVyQ29udHJvbE5vZGVBcnJheSA9IFtdO1xuICAgICAgICB9XG4gICAgICAgIGNvbnNvbGUubG9nKFwic3Bhd25Cb3R0b21DYXJkIFwiICsgdGhpcy5wb2tlclBsYXllclswXS5sZW5ndGgpO1xuICAgICAgICB0aGlzLmNyZWF0ZUJvdHRvbUNhcmQoKVxuXG4gICAgfSxcblxuICAgIGNyZWF0ZUJvdHRvbUNhcmQ6IGZ1bmN0aW9uICgpIHtcblxuICAgICAgICBsZXQgc3RhcnRQb3NpdGlvbiA9IDA7XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5wb2tlclBsYXllclswXS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgLy8g5L2/55So57uZ5a6a55qE5qih5p2/5Zyo5Zy65pmv5Lit55Sf5oiQ5LiA5Liq5paw6IqC54K5XG4gICAgICAgICAgICB2YXIgbmV3U3RhciA9IGNjLmluc3RhbnRpYXRlKHRoaXMuY2FyZFByZWZhYik7XG4gICAgICAgICAgICAvLyBuZXdTdGFyLnNldFBpY051bShcImlcIitpKTtcbiAgICAgICAgICAgIG5ld1N0YXIuZ2V0Q29tcG9uZW50KCdDYXJkJykucGljTnVtID0gdGhpcy5wb2tlclBsYXllclswXVtpXTtcbiAgICAgICAgICAgIHRoaXMucGxheWVyQ29udHJvbE5vZGVBcnJheS5wdXNoKG5ld1N0YXIpO1xuICAgICAgICAgICAgLy8gdGhpcy5ub2RlLmFkZENoaWxkKG5ld1N0YXIpO1xuICAgICAgICAgICAgdGhpcy5sYXlvdXRDb250YWluZXIubm9kZS5hZGRDaGlsZChuZXdTdGFyKTtcbiAgICAgICAgICAgIGxldCBoZWlnaHQgPSB0aGlzLmdyb3VuZC5oZWlnaHQgLyAyICogLTE7XG4gICAgICAgICAgICBzdGFydFBvc2l0aW9uID0gaSAqIHRoaXMuY2FyZFdpZHRoO1xuICAgICAgICAgICAgaWYgKGkgPiAxMykge1xuICAgICAgICAgICAgICAgIGhlaWdodCA9IGhlaWdodCAtIDE1MFxuICAgICAgICAgICAgICAgIHN0YXJ0UG9zaXRpb24gPSAoaSAtIDEzKSAqIHRoaXMuY2FyZFdpZHRoO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gbmV3U3Rhci5zZXRQb3NpdGlvbihjYy52MigtMjAwICsgdGhpcy5zdGFydENhcmRQb3N0aW9uICsgc3RhcnRQb3NpdGlvbiwgaGVpZ2h0KSk7XG4gICAgICAgIH1cbiAgICB9LFxuXG5cbiAgICBnZXROZXdTdGFyUG9zaXRpb246IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHJhbmRYID0gMDtcbiAgICAgICAgLy8g5qC55o2u5Zyw5bmz6Z2i5L2N572u5ZKM5Li76KeS6Lez6LeD6auY5bqm77yM6ZqP5py65b6X5Yiw5LiA5Liq5pif5pif55qEIHkg5Z2Q5qCHXG4gICAgICAgIHZhciByYW5kWSA9IHRoaXMuZ3JvdW5kWSArIE1hdGgucmFuZG9tKCkgKiB0aGlzLnBsYXllci5nZXRDb21wb25lbnQoJ1BsYXllcicpLmp1bXBIZWlnaHQgKyA1MDtcbiAgICAgICAgLy8g5qC55o2u5bGP5bmV5a695bqm77yM6ZqP5py65b6X5Yiw5LiA5Liq5pif5pifIHgg5Z2Q5qCHXG4gICAgICAgIHZhciBtYXhYID0gdGhpcy5ub2RlLndpZHRoIC8gMjtcbiAgICAgICAgcmFuZFggPSAoTWF0aC5yYW5kb20oKSAtIDAuNSkgKiAyICogbWF4WDtcbiAgICAgICAgLy8g6L+U5Zue5pif5pif5Z2Q5qCHXG4gICAgICAgIHJldHVybiBjYy52MihyYW5kWCwgcmFuZFkpO1xuICAgIH0sXG4gICAgZ2V0Q2FyZEJvdHRvbVBvc2l0aW9uOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciByYW5kWCA9IHRoaXMuY3VycmVudENhcmRQb3NpdGlvbjtcbiAgICAgICAgdmFyIHJhbmRZID0gMDtcbiAgICAgICAgdGhpcy5jdXJyZW50Q2FyZFBvc2l0aW9uID0gdGhpcy5jdXJyZW50Q2FyZFBvc2l0aW9uICsgdGhpcy5jYXJkV2lkdGg7XG4gICAgICAgIHJldHVybiBjYy52MihyYW5kWCwgcmFuZFkpO1xuICAgIH0sXG5cbiAgICB1cGRhdGU6IGZ1bmN0aW9uIChkdCkge1xuICAgICAgICAvLyDmr4/luKfmm7TmlrDorqHml7blmajvvIzotoXov4fpmZDluqbov5jmsqHmnInnlJ/miJDmlrDnmoTmmJ/mmJ9cbiAgICAgICAgLy8g5bCx5Lya6LCD55So5ri45oiP5aSx6LSl6YC76L6RXG4gICAgICAgIC8vIGlmICh0aGlzLnRpbWVyID4gdGhpcy5zdGFyRHVyYXRpb24pIHtcbiAgICAgICAgLy8gICAgIHRoaXMuZ2FtZU92ZXIoKTtcbiAgICAgICAgLy8gICAgIHRoaXMuZW5hYmxlZCA9IGZhbHNlOyAgIC8vIGRpc2FibGUgZ2FtZU92ZXIgbG9naWMgdG8gYXZvaWQgbG9hZCBzY2VuZSByZXBlYXRlZGx5XG4gICAgICAgIC8vICAgICByZXR1cm47XG4gICAgICAgIC8vIH1cbiAgICAgICAgLy8gdGhpcy50aW1lciArPSBkdDtcbiAgICB9LFxuXG4gICAgZ2FpblNjb3JlOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuc2NvcmUgKz0gMTtcbiAgICAgICAgLy8g5pu05pawIHNjb3JlRGlzcGxheSBMYWJlbCDnmoTmloflrZdcbiAgICAgICAgdGhpcy5zY29yZURpc3BsYXkuc3RyaW5nID0gJ1Njb3JlOiAnICsgdGhpcy5zY29yZTtcbiAgICAgICAgLy8g5pKt5pS+5b6X5YiG6Z+z5pWIXG4gICAgICAgIGNjLmF1ZGlvRW5naW5lLnBsYXlFZmZlY3QodGhpcy5zY29yZUF1ZGlvLCBmYWxzZSk7XG4gICAgfSxcblxuICAgIGdhbWVPdmVyOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMucGxheWVyLnN0b3BBbGxBY3Rpb25zKCk7IC8v5YGc5q2iIHBsYXllciDoioLngrnnmoTot7Pot4PliqjkvZxcbiAgICAgICAgY2MuZGlyZWN0b3IubG9hZFNjZW5lKCdnYW1lJyk7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICog5oqK54mM5Y+R57uZ5Zub5a62XG4gICAgKi9cbiAgICBwdWJsaXNoUG9rZXJzOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMucG9rZXJQbGF5ZXIgPSBbXTtcbiAgICAgICAgdGhpcy5nYW1lSG9zdD1udWxsO1xuICAgICAgICBsZXQgcG9rZXJBcnJheSA9IHRoaXMuY2FyZEFycmF5LnNsaWNlKDApO1xuICAgICAgICBsZXQgaG9zdD1wYXJzZUludChNYXRoLnJhbmRvbSgpICogNCk7Ly/pmo/mnLrkuLvniYzoirHoibJcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCA0OyBpKyspIHtcbiAgICAgICAgICAgIGxldCBwbGF5ZXJQb2tlckFycmF5ID0gW107XG4gICAgICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IDI3OyBqKyspIHtcbiAgICAgICAgICAgICAgICBsZXQgcG9rZXJOdW0gPSBNYXRoLnJhbmRvbSgpICogcG9rZXJBcnJheS5sZW5ndGg7XG4gICAgICAgICAgICAgICAgcG9rZXJOdW0gPSBwYXJzZUludChwb2tlck51bSk7XG4gICAgICAgICAgICAgICAgLy/mj5LlhaXmiYvniYzkuK1cbiAgICAgICAgICAgICAgICBsZXQgdmFsdWUgPSBwb2tlckFycmF5LnNwbGljZShwb2tlck51bSwgMSk7XG4gICAgICAgICAgICAgICAgcGxheWVyUG9rZXJBcnJheS5wdXNoKHZhbHVlKTtcbiAgICAgICAgICAgICAgICBpZih0aGlzLmdhbWVIb3N0PT1udWxsKXsvL+maj+acuuWIsOS4u+WQju+8jOesrOS4gOW8oOS4u+eJjOS6ruWHulxuICAgICAgICAgICAgICAgICAgICBpZihob3N0PT1Qb2tlclV0aWwucXVhcnlQb2tlclR5cGVWYWx1ZSh2YWx1ZSkpe1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5nYW1lSG9zdD12YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYXBwZW5kTG9nKFwi5pys6L2u5ri45oiP5Li7XCIrUG9rZXJVdGlsLnF1YXJ5VHlwZSh0aGlzLmdhbWVIb3N0KVxuICAgICAgICAgICAgICAgICAgICAgICAgK1wiLOS4u+eJjFwiK1Bva2VyVXRpbC5xdWFyeVBva2VyVmFsdWUodmFsdWUpK1wi5ZyoXCIrdGhpcy5leHBhbmRQbGF5ZXIoaSkpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgbGV0IHBsYXllck9iaj1Qb2tlclV0aWwuc29ydFBva2Vycyhob3N0LHBsYXllclBva2VyQXJyYXkpO1xuICAgICAgICAgICAgY29uc29sZS5sb2coXCJvbmlvblwiLEpTT04uc3RyaW5naWZ5KHBsYXllck9iaikpO1xuICAgICAgICAgICAgdGhpcy5wb2tlclBsYXllci5wdXNoKHBsYXllck9iai50b3RhbCk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5zcGF3bkJvdHRvbUNhcmQoKTtcblxuICAgIH0sXG4gICAgZXhwYW5kUGxheWVyOmZ1bmN0aW9uKGxvY2F0aW9uKXtcbiAgICAgICAgc3dpdGNoKGxvY2F0aW9uKXtcbiAgICAgICAgICAgIGNhc2UgMDpyZXR1cm4gXCLoh6rlt7FcIlxuICAgICAgICAgICAgY2FzZSAxOnJldHVybiBcIuS4i+WutlwiXG4gICAgICAgICAgICBjYXNlIDI6cmV0dXJuIFwi5a+55a62XCJcbiAgICAgICAgICAgIGNhc2UgMzpyZXR1cm4gXCLkuIrlrrZcIiAgIFxuICAgICAgICB9XG5cbiAgICB9LFxuICAgIGFwcGVuZExvZzpmdW5jdGlvbihzdHJpbmcpe1xuICAgICAgICB0aGlzLnBsYXlMb2c9dGhpcy5wbGF5TG9nK1wiXFxuXCIrc3RyaW5nO1xuICAgICAgICB0aGlzLmxvZ0xhYmVsLnN0cmluZz10aGlzLnBsYXlMb2c7XG4gICAgfVxuICAgIFxuICAgIFxuXG5cblxufSk7XG4iXX0=